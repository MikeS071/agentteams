# AS-16: Swarm status TUI rendered as collapsible top panel in Chat + Swarm workspace tab

## Scope
When a user runs an agent-swarm, the status renders in two places:
1. **Collapsible top panel in Chat UI** â€” slides down from top, user can chat underneath
2. **Swarm workspace tab** (`/dashboard/swarm`) â€” full dedicated view

## Swarm Status Component
Create `apps/web/src/components/SwarmStatus.tsx`:

### Props
```typescript
type SwarmStatusProps = {
  projectName?: string;
  compact?: boolean;
  onClose?: () => void;
};
```

### Full mode (Swarm tab)
- Header: project name, active phase, stats bar (done/running/todo/failed)
- Ticket table: ID, phase, status badge (done=green, running=blue+pulse, todo=gray, failed=red, blocked=yellow), description
- Running tickets show elapsed time, expandable to see agent output
- Progress bar: % complete
- Phase indicator: visual steps (Phase 1 âœ… â†’ Phase 2 ğŸ”„ â†’ Phase 3 â¬š)
- Phase gate approval button when pending

### Compact mode (collapsible top panel in Chat)
**Collapsed (default):** single row:
`â–¼ Swarm: agentsquads  â–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘ 3/12 done Â· 2 running  [âœ•]`

**Expanded:** slides down ~200px:
- Phase indicator strip
- Running tickets (ID + status + desc, compact rows)
- Recently completed (last 2-3)
- Failed tickets highlighted red
- Click â–² to collapse, âœ• to dismiss

### Layout in Chat
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Agent Mode Selector (compact strip)     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â–¼ Swarm: agentsquads  â–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘ 3/12  2â–¶  â”‚  â† collapsed
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Chat messages area (scrollable)        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ [+ New] [input field...        ] [Send] â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

Expanded pushes messages down but chat remains fully usable.

### Animation
- `transition-all duration-300 ease-in-out` with `max-height` toggle
- New ticket completing: brief green flash

## Chat integration
In `apps/web/src/app/dashboard/chat/page.tsx`:
- State: `const [swarmVisible, setSwarmVisible] = useState(false)`
- Auto-show when assistant sends message with `type: "swarm_status"` JSON
- Panel sits ABOVE chat messages, pushes them down when expanded

## API endpoint
Create `apps/web/src/app/api/swarm/status/route.ts`:
- GET: reads swarm tracker state, query `?project=<name>`
- Returns: `{ project, phase, stats, tickets }`
- Polls every 5s from client

## Swarm workspace tab
Update `apps/web/src/app/dashboard/swarm/page.tsx`:
- Full `<SwarmStatus />` as main content
- Project selector dropdown
- "Approve Phase Gate" button

## Styling
- Top panel: bg-[#0d0d14] border-b border-[#1d1d2c]
- Collapsed: h-10 flex items-center
- Status badges: rounded-full px-2 py-0.5 text-xs
- Running: animate-pulse blue dot

## Rules
- Branch: `feat/as-16`
- Commit: `feat: swarm TUI â€” collapsible top panel in chat + swarm tab`
- Verify build passes
